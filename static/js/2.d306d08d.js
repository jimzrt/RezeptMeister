(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"0a41":function(e,t,a){"use strict";var i=a("b268"),s=a.n(i);s.a},"0c66":function(e,t,a){},"0d77":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-layout",{staticClass:"bg-grey-1",attrs:{view:"hHh Lpr lff"}},[a("q-ajax-bar",{attrs:{position:"bottom",color:"primary",size:"10px"}}),a("q-page-container",[a("q-header",{staticClass:"text-grey-1 q-py-xs edekaBar",attrs:{"height-hint":"65"}},[a("q-toolbar",[a("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Menu",icon:"menu"},on:{click:function(t){e.leftDrawerOpen=!e.leftDrawerOpen}}}),e.$q.screen.gt.sm?a("q-btn",{attrs:{flat:"","no-caps":"","no-wrap":"",padding:"0px 5px 0px 10px"}},[a("img",{attrs:{src:"/images/logo.png",height:"50px"}}),a("q-toolbar-title",{staticClass:"text-weight-bold my-font",attrs:{shrink:""}},[e._v("\n          RezeptMeister\n        ")])],1):e._e(),a("q-space"),a("div",{staticStyle:{position:"relative",height:"45px","min-width":"200px",width:"75%"}},[a("q-input",{ref:"searchBar",staticClass:"YL__toolbar-input",class:{active:e.searchFocus||!e.searchFilterEmpty},attrs:{dense:"",standout:"bg-primary",placeholder:"Zutat oder Gericht","bottom-slots":"",debounce:"200","bg-color":"grey-5"},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.selectNextSuggestion(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.selectPrevSuggestion(t)}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[""===e.searchInput?a("q-icon",{staticClass:"justify-center",attrs:{name:"search"}}):a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(t){e.searchInput=""}}})]},proxy:!0},{key:"hint",fn:function(){return[a("transition",{attrs:{name:"slide-fade"}},[a("SearchResultList",{directives:[{name:"show",rawName:"v-show",value:e.searchFocus,expression:"searchFocus"}],ref:"searchResult",attrs:{search:e.searchInput},on:{onAddToSearch:e.addToSearch,onClearSearch:function(t){e.searchInput="",e.searchFocus=!1}}})],1)]},proxy:!0}]),model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}})],1),a("q-space"),a("div",{staticClass:"q-gutter-sm row items-center no-wrap"},[a("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"favorite"}},[a("q-badge",{attrs:{color:"red","text-color":"white",floating:""}},[e._v(" 2 ")]),a("q-tooltip",[e._v("Merkliste")])],1)],1)],1)],1),a("RecipeResultGrid",{style:{"margin-top":e.searchFilterEmpty?"15px":"80px"},on:{onAddToSearch:e.addToSearch},model:{value:e.searchFilter,callback:function(t){e.searchFilter=t},expression:"searchFilter"}}),e.searchFilterEmpty?e._e():a("SearchFilterBar",{on:{onAddToSearch:e.addToSearch,onRemoveFromSearch:e.removeFromSearch},model:{value:e.searchFilter,callback:function(t){e.searchFilter=t},expression:"searchFilter"}})],1)],1)},s=[],r=(a("c975"),a("a434"),a("ddb0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"searchResult"},[""==this.search?void 0:[a("q-list",{attrs:{bordered:"",separator:"",padding:""}},[a("q-item-label",{staticClass:"heading",attrs:{header:""}},[e._v("Zutaten")]),e.ingredients.length>0?e._l(e.ingredients,(function(t,i){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.slug,staticClass:"list-complete-item",attrs:{clickable:"",active:e.selectedIndex==i,"active-class":"bg-blue-1"},on:{click:function(a){return e.addToSearch("ingredient",{id:t.id,name:t.name})}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{circle:"",size:"60px"}},[a("q-img",{attrs:{src:t.pictureUrl}})],1)],1),a("q-item-section",{attrs:{"no-wrap":""}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-8"},[a("h6",{staticClass:"resultHeading"},[a("span",{domProps:{innerHTML:e._s(e.makeBold(t.name))}})])])])]),a("q-item-section",{attrs:{side:""}},[void 0==t.recipeCount?a("q-spinner-dots",{attrs:{color:"primary",size:"60px"}}):a("q-chip",[a("q-avatar",{attrs:{color:"primary","text-color":"white","font-size":"14px"}},[e._v(e._s(t.recipeCount))]),e._v("\n              Rezept"+e._s(1!=t.recipeCount?"e":"")+"\n            ")],1)],1)],1)})):this.loading?e._l(7,(function(e){return a("q-item",{key:e+"I",staticStyle:{"max-width":"400px"}},[a("q-item-section",{attrs:{avatar:""}},[a("q-skeleton",{attrs:{size:"60px",type:"QAvatar"}})],1),a("q-item-section",[a("q-item-label",[a("q-skeleton",{attrs:{type:"text"}})],1),a("q-item-label",{attrs:{caption:""}},[a("q-skeleton",{attrs:{type:"text",width:"65%"}})],1)],1)],1)})):e._e(),a("q-item-label",{staticClass:"heading",attrs:{header:""}},[e._v("Rezepte")]),e.recipes.length>0?e._l(e.recipes,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.seoTitle,staticClass:"list-complete-item",attrs:{clickable:"",to:"/rezept/"+t.id}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{circle:"",size:"60px"}},[a("q-img",{attrs:{src:t.pictureUrl}})],1)],1),a("q-item-section",{attrs:{"no-wrap":""}},[a("h6",{staticClass:"resultHeading"},[a("span",{domProps:{innerHTML:e._s(e.makeBold(t.title))}})])])],1)})):this.loading?e._l(3,(function(e){return a("q-item",{key:e+"R",staticStyle:{"max-width":"400px"}},[a("q-item-section",{attrs:{avatar:""}},[a("q-skeleton",{attrs:{size:"60px",type:"QAvatar"}})],1),a("q-item-section",[a("q-item-label",[a("q-skeleton",{attrs:{type:"text"}})],1),a("q-item-label",{attrs:{caption:""}},[a("q-skeleton",{attrs:{type:"text",width:"65%"}})],1)],1)],1)})):e._e(),a("q-item-label",{staticClass:"heading",attrs:{header:""}},[e._v("Kategorien")]),a("q-item",[a("q-item-section",[e.tags.length>0?a("div",e._l(e.tags,(function(t){return a("q-chip",{key:t.id,attrs:{clickable:"",color:"primary","text-color":"white"},on:{click:function(a){return e.addToSearch("tag",{id:t.id,name:t.name})}}},[a("span",{domProps:{innerHTML:e._s(e.makeBold(t.name))}})])})),1):this.loading?a("div",e._l(7,(function(e){return a("q-skeleton",{key:e+"T",staticStyle:{display:"inline-flex","margin-right":"10px"},attrs:{type:"QChip"}})})),1):e._e()])],1)],2)]],2)}),n=[],o=(a("e6cf"),a("8df4")),c=a.n(o),l={name:"SearchResultList",props:{search:{type:String,required:!0}},data(){return{selectedIndex:-1,ingredients:[],recipes:[],tags:[],loading:!1,cancelToken:c.a.source(),promises:[]}},filters:{},methods:{makeBold(e){if(!e)return"";const t=e.toLowerCase(),a=this.search.toLowerCase(),i=t.indexOf(a);let s="";return s+=e.substring(0,i),s+="<span class='text-weight-bolder' style='text-decoration: underline'>"+e.substring(i,i+a.length)+"</span>",s+=e.substring(i+a.length,e.length),s},addToSearch(e,t){this.$emit("onAddToSearch",e,t)},selectNext(){this.selectedIndex++,console.log(this.selectedIndex)},selectPrev(){this.selectedIndex--,console.log(this.selectedIndex)},async loadData(e){this.cancelToken.cancel();let t=await Promise.all(this.promises);console.log("ending2");for(let i of t)Array.isArray(i)&&await Promise.all(i);if(this.cancelToken=c.a.source(),this.selectedIndex=-1,this.ingredients=[],this.recipes=[],this.tags=[],this.promises=[],""==e)return;this.loading=!0,console.log("starting"),console.log(this.$axios.defaults.baseURL);let a=this.promises.length;this.promises[a]=this.$axios.get("/ingredient",{cancelToken:this.cancelToken.token,params:{name:e,count:7}}).then((e=>{let t=[];this.ingredients=e.data;for(let a=0;a<this.ingredients.length;a++)t[t.length]=this.$axios.get("/recipe/count",{cancelToken:this.cancelToken.token,params:{ingredientId:this.ingredients[a].id}}).then((e=>{this.ingredients[a].recipeCount=e.data,this.$set(this.ingredients,a,this.ingredients[a])})).catch((()=>{console.log("aborted")}));return t})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})})),this.promises[this.promises.length]=this.$axios.get("/recipe",{cancelToken:this.cancelToken.token,params:{name:e,count:3}}).then((e=>{console.log(e.data),this.recipes=e.data})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})})),this.promises[this.promises.length]=this.$axios.get("/tag",{params:{cancelToken:this.cancelToken.token,name:e,count:7}}).then((e=>{console.log(e.data),this.tags=e.data})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})})),Promise.all(this.promises).then((e=>{this.loading=!1,console.log("ending")}))}},mounted:function(){console.log("mounted"),console.log(this.search),this.loadData(this.search)},watch:{"$props.search":{handler:function(e,t){console.log("watch",t,e),this.loadData(this.search)},deep:!0}}},d=l,h=(a("9624"),a("a8cc"),a("2877")),p=a("1c1c"),u=a("0170"),m=a("66e5"),g=a("4074"),f=a("cb32"),v=a("068f"),y=a("8380"),b=a("b047"),q=a("293e"),x=a("714f"),k=a("eebe"),S=a.n(k),w=Object(h["a"])(d,r,n,!1,null,"5fab721e",null),C=w.exports;S()(w,"components",{QList:p["a"],QItemLabel:u["a"],QItem:m["a"],QItemSection:g["a"],QAvatar:f["a"],QImg:v["a"],QSpinnerDots:y["a"],QChip:b["a"],QSkeleton:q["a"]}),S()(w,"directives",{Ripple:x["a"]});var Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page-sticky",{staticStyle:{transform:"translate(0px, 60px)"},attrs:{expand:"",position:"top"}},[a("q-toolbar",{staticClass:"bg-grey-3 shadow-1"},[e._l(e.nonEmptyFilter,(function(t,i){return a("div",{key:t},[i>0?[a("q-separator",{attrs:{vertical:""}})]:e._e(),a("q-btn",{attrs:{stretch:"",flat:"",label:e._f("canonicalName")(t)}}),e._l(e.value[t],(function(i){return a("q-chip",{key:i.id,attrs:{dense:"",square:"",removable:"",color:"primary","text-color":"white"},on:{remove:function(a){return e.removeFromSearch(t,i)}}},[e._v(e._s(i.name))])}))],2)})),a("q-select",{staticStyle:{width:"220px"},attrs:{filled:"",options:e.options,label:"Schwierigkeit",multiple:"","emit-value":"",value:e.model},on:{input:e.difficultyChanged},scopedSlots:e._u([{key:"option",fn:function(t){return[a("q-item",e._g(e._b({},"q-item",t.itemProps,!1),t.itemEvents),[a("q-item-section",[a("q-item-label",{domProps:{innerHTML:e._s(t.opt)}})],1),a("q-item-section",{attrs:{side:""}},[a("q-toggle",{attrs:{value:e.model,val:t.opt},on:{input:e.difficultyChanged}})],1)],1)]}}])})],2)],1)},F=[],T=(a("4e82"),a("2ef0"),{name:"SearchFilterBar",props:["value"],computed:{nonEmptyFilter(){return Object.keys(this.value).sort().filter((e=>"difficulty"!=e&&this.value[e].length>0))}},filters:{canonicalName(e){switch(e){case"ingredient":return"Zutaten";case"recipe":return"Rezepte";case"tag":return"Kategorien";default:return e}}},methods:{englishDifficulty(e){switch(e){case"Einfach":return"EASY";case"Medium":return"MEDIUM";case"Schwer":return"HARD";default:return e}},difficultyChanged(e){this.model.length>e.length?(console.log("remove"),this.$emit("onRemoveFromSearch","difficulty",this.englishDifficulty(_.difference(this.model,e)[0]))):(console.log("add",_.difference(e,this.model)),this.$emit("onAddToSearch","difficulty",this.englishDifficulty(_.difference(e,this.model)[0]))),this.model=e},removeFromSearch(e,t){this.$emit("onRemoveFromSearch",e,t)},log(e,t){this.dataCopy=_.clone(this.value),_.remove(this.dataCopy[e],t),this.updateData()},updateData(){this.$emit("input",this.dataCopy)}},data(){return{dataCopy:{},model:[],options:["Einfach","Medium","Schwer"]}}}),R=T,I=(a("7221"),a("de5e")),$=a("65c6"),D=a("eb85"),E=a("9c40"),P=a("ddd8"),L=a("9564"),A=Object(h["a"])(R,Q,F,!1,null,"8536328c",null),z=A.exports;S()(A,"components",{QPageSticky:I["a"],QToolbar:$["a"],QSeparator:D["a"],QBtn:E["a"],QChip:b["a"],QSelect:P["a"],QItem:m["a"],QItemSection:g["a"],QItemLabel:u["a"],QToggle:L["a"]});var O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("transition",{attrs:{name:"list"}},[e.currentRecipes.content&&e.currentRecipes.content.length>0?a("div",{staticClass:"q-pa-xl row items-center flex-center q-gutter-xl",staticStyle:{"margin-bottom":"80px"}},e._l(e.currentRecipes.content,(function(t){return a("Flipped",{key:t.id,attrs:{"flip-id":t.seoTitle,scale:"",translate:""}},[a("q-card",{staticClass:"my-card"},[a("q-img",{attrs:{src:t.pictureUrl}},[a("div",{staticClass:"absolute-top text-subtitle2"},[e._v("\n          "+e._s(e._f("germanDifficulty")(t.difficulty))+"\n        ")])]),a("q-card-section",[a("q-btn",{staticClass:"absolute",staticStyle:{top:"0",right:"12px",transform:"translateY(-50%)"},attrs:{fab:"",size:"xs",color:"blue-grey-7",label:"Rezept",to:"/rezept/"+t.seoTitle}}),a("div",{staticClass:"row no-wrap items-center"},[a("div",{staticClass:"text-h6 my-font col ellipsis"},[e._v(e._s(t.title))]),a("div",{staticClass:"col-auto text-grey text-caption q-pt-md column no-wrap items-center"},[a("div",[e._v(e._s(t.calories)+" kcal")]),a("div",[e._v(e._s(t.preperationTime))])])])],1),a("q-separator"),a("q-card-section",{attrs:{horizontal:""}},[a("q-card-section",{staticClass:"text-body2",staticStyle:{"align-items":"center",display:"flex","text-align":"justify"}},[e._v("\n            "+e._s(t.description)+"\n          ")]),a("q-separator",{staticStyle:{"flex-shrink":"0"},attrs:{vertical:""}}),a("q-card-section",{staticClass:"col-4 text-caption",staticStyle:{"text-align":"center"}},e._l(t.tags.slice(0,5),(function(t){return a("q-chip",{key:t.id,attrs:{dense:"",square:"",clickable:""},on:{click:function(a){return e.addToSearch("tag",t)}}},[e._v("\n              "+e._s(t.name)+"\n            ")])})),1)],1),a("q-separator"),a("q-card-section",{attrs:{horizontal:""}},[a("q-card-section",{staticClass:"text-body2"},e._l(t.ingredients,(function(t){return a("q-chip",{key:t.id,attrs:{dense:"",square:"",clickable:""},on:{click:function(a){return e.addToSearch("ingredient",t)}}},[e._v("\n              "+e._s(e._f("truncate")(t.name))+"\n            ")])})),1)],1)],1)],1)})),1):e.searchFilterEmpty||e.loading?e._e():a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[a("h4",[e._v("Keine Rezepte gefunden :(")])])]),e.currentRecipes.content?[a("q-page-sticky",{staticStyle:{background:"white"},attrs:{expand:"",position:"bottom"}},[a("div",{staticClass:"q-pa-md flex flex-center"},[a("q-pagination",{attrs:{"direction-links":!0,value:e.currentPage,max:e.currentRecipes.totalPages,"max-pages":6,"boundary-numbers":!0},on:{input:e.changePage}})],1)])]:e._e()],2)},j=[],B=a("0129"),M={name:"RecipeResultGrid",props:["value"],components:{Flipped:B["Flipped"]},computed:{nonEmptyFilter(){return Object.keys(this.value).sort().filter((e=>this.value[e].length>0))},searchFilterEmpty(){for(const e of Object.keys(this.value))if(this.value[e].length>0)return!1;return!0}},filters:{truncate(e){return e.length<=13?e:e.substring(0,10)+"..."},germanDifficulty(e){switch(e){case"EASY":return"Einfach";case"MEDIUM":return"Medium";case"HARD":return"Schwer";default:return e}},canonicalName(e){switch(e){case"ingredient":return"Zutaten";case"recipe":return"Rezepte";case"tag":return"Kategorien";default:return e}}},methods:{addToSearch(e,t){this.$emit("onAddToSearch",e,t)},styleIngredients(e){return e.map((e=>this.value["ingredient"]&&this.value["ingredient"].some((t=>t.id===e.id))?"<span class='text-weight-bold'>"+e.name+"</span>":e.name)).join(", ")},changePage(e){console.log(e),this.currentPage!=e&&(this.currentPage=e,this.loadData())},log(e,t){this.dataCopy=_.clone(this.value),_.remove(this.dataCopy[e],t),this.updateData()},updateData(){this.$emit("input",this.dataCopy)},loadData(){this.loading=!0;let e={};Object.keys(this.value).forEach((t=>{e[t]=this.value[t].map((e=>"string"==typeof e?e:e.id))})),e["page"]=this.currentPage-1,e["count"]=this.resultCount,console.log(e),this.$axios.post("/recipe/search",e).then((e=>{this.currentRecipes=e.data,console.log(e.data)})).catch((()=>{this.currentRecipes=[],this.$q.notify({color:"negative",position:"top",message:"Loading failed",icon:"report_problem"})})).then((()=>{this.loading=!1,window.scrollTo(0,0)}))}},data(){return{loading:!1,dataCopy:{},currentRecipes:[],currentPage:1,resultCount:12,lorem:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}},watch:{"$props.value":{handler:function(e,t){if(console.log("watch Searchfilter",t,e),this.searchFilterEmpty)return this.currentRecipes=[],void(this.currentPage=1);this.currentPage=1,this.loadData()},deep:!0}}},N=M,H=(a("0a41"),a("3a25"),a("f09f")),U=a("a370"),G=a("0016"),K=a("3b16"),Y=Object(h["a"])(N,O,j,!1,null,"6a878dd1",null),Z=Y.exports;S()(Y,"components",{QCard:H["a"],QImg:v["a"],QCardSection:U["a"],QBtn:E["a"],QIcon:G["a"],QSeparator:D["a"],QChip:b["a"],QPageSticky:I["a"],QPagination:K["a"]});const J=["Google","Facebook","Twitter","Apple","Oracle"];var V={name:"RecipeSearch",components:{RecipeResultGrid:Z,SearchResultList:C,SearchFilterBar:z},data(){return{model:null,searchFocus:!1,filterOptions:J,leftDrawerOpen:!0,searchInput:"",selected:"",searchFilter:{}}},mounted(){document.addEventListener("click",this.onClickAnywhere)},beforeDestroy(){document.removeEventListener("click",this.onClickAnywhere)},computed:{searchFilterEmpty(){for(const e of Object.keys(this.searchFilter))if(this.searchFilter[e].length>0)return!1;return!0}},methods:{addToSearch(e,t){if(console.log("add",e,t),this.searchInput="","recipe"!=e){if(e in this.searchFilter){if(_.some(this.searchFilter[e],t))return}else this.$set(this.searchFilter,e,[]);this.searchFilter[e].push(t)}},removeFromSearch(e,t){console.log("remove",e,t),this.searchFilter[e].splice(this.searchFilter[e].indexOf(t),1)},selectNextSuggestion:function(){this.$refs.searchResult.selectNext()},selectPrevSuggestion:function(){this.$refs.searchResult.selectPrev()},onClickAnywhere(e){const t=this.$refs.searchBar.$el;t==e.target||t.contains(e.target)?(console.log("INSIDE"),this.searchFocus=!0):(console.log("OUTSIDE"),this.searchFocus=!1)}}},W=V,X=(a("e0de"),a("80d7"),a("4d5a")),ee=a("7ea5"),te=a("09e3"),ae=a("e359"),ie=a("6ac5"),se=a("2c91"),re=a("27f9"),ne=a("58a81"),oe=a("05c0"),ce=a("9404"),le=a("4983"),de=a("8572"),he=Object(h["a"])(W,i,s,!1,null,"6cacb38f",null);t["default"]=he.exports;S()(he,"components",{QLayout:X["a"],QAjaxBar:ee["a"],QPageContainer:te["a"],QHeader:ae["a"],QToolbar:$["a"],QBtn:E["a"],QToolbarTitle:ie["a"],QSpace:se["a"],QInput:re["a"],QIcon:G["a"],QBadge:ne["a"],QTooltip:oe["a"],QDrawer:ce["a"],QScrollArea:le["a"],QList:p["a"],QItem:m["a"],QItemSection:g["a"],QItemLabel:u["a"],QSeparator:D["a"],QField:de["a"]}),S()(he,"directives",{Ripple:x["a"]})},"2d17":function(e,t,a){},"3a25":function(e,t,a){"use strict";var i=a("400a"),s=a.n(i);s.a},"400a":function(e,t,a){},"61f9":function(e,t,a){},"6f38":function(e,t,a){},7221:function(e,t,a){"use strict";var i=a("2d17"),s=a.n(i);s.a},"770b":function(e,t,a){},"80d7":function(e,t,a){"use strict";var i=a("0c66"),s=a.n(i);s.a},9624:function(e,t,a){"use strict";var i=a("6f38"),s=a.n(i);s.a},a8cc:function(e,t,a){"use strict";var i=a("61f9"),s=a.n(i);s.a},b268:function(e,t,a){},e0de:function(e,t,a){"use strict";var i=a("770b"),s=a.n(i);s.a}}]);